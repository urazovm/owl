= render partial: 'layouts/header'

- cache ['v1', 'lists', 'header'] do
  .row= render partial: 'lists/categories'
  .row= render partial: 'lists/search', locals: { category_id: @category_id }

.row
  .col-sm-12
    - if defined?(@tmp_lists)
      - cache ['v1', tmp_list_cookie_updated_at] do
        = render partial: 'lists/tmp', locals: { lists: @tmp_lists.decorate }

    - cache ['v1', cache_key_for_lists, params[:category_id], params[:q], params[:page]] do
      = render partial: 'lists/list', locals: { lists: @lists } if @lists.count > 0

%script
  = "window.owl.env['category_id'] = #{@category_id||999};"
  = "window.owl.env['query'] = '#{@query||''}';"
